<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Passenger: Passenger::Application Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.8 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath"><b>Passenger</b>::<a class="el" href="classPassenger_1_1Application.html">Application</a>
  </div>
</div>
<div class="contents">
<h1>Passenger::Application Class Reference<br>
<small>
[<a class="el" href="group__Support.html">Apache-independent support classes and function</a>]</small>
</h1><!-- doxytag: class="Passenger::Application" -->Represents a single Ruby on Rails or Rack application instance.  
<a href="#_details">More...</a>
<p>
<code>#include &lt;<a class="el" href="Application_8h-source.html">Application.h</a>&gt;</code>
<p>

<p>
<a href="classPassenger_1_1Application-members.html">List of all members.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Classes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">class &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPassenger_1_1Application_1_1Session.html">Session</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Represents the life time of a single request/response pair of a Ruby on Rails or Rack application.  <a href="classPassenger_1_1Application_1_1Session.html#_details">More...</a><br></td></tr>
<tr><td colspan="2"><br><h2>Public Types</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">typedef shared_ptr&lt; <a class="el" href="classPassenger_1_1Application_1_1Session.html">Session</a> &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPassenger_1_1Application.html#d14f673494991460b16246a527ad8ad9">SessionPtr</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Convenient alias for <a class="el" href="classPassenger_1_1Application_1_1Session.html" title="Represents the life time of a single request/response pair of a Ruby on Rails or...">Session</a> smart pointer.  <a href="#d14f673494991460b16246a527ad8ad9"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPassenger_1_1Application.html#0ae83471a8c991b8cc8d460b44d237ea">Application</a> (const string &amp;theAppRoot, pid_t pid, const string &amp;listenSocketName, const string &amp;listenSocketType, int ownerPipe)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Construct a new <a class="el" href="classPassenger_1_1Application.html" title="Represents a single Ruby on Rails or Rack application instance.">Application</a> object.  <a href="#0ae83471a8c991b8cc8d460b44d237ea"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPassenger_1_1Application.html#0a0665852e7ebc8fb8ab0772fa90bc56">getAppRoot</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns the application root for this application.  <a href="#0a0665852e7ebc8fb8ab0772fa90bc56"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="94d2cce1c2c1d3441325f1498a22bf02"></a><!-- doxytag: member="Passenger::Application::getPid" ref="94d2cce1c2c1d3441325f1498a22bf02" args="() const " -->
pid_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPassenger_1_1Application.html#94d2cce1c2c1d3441325f1498a22bf02">getPid</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns the process ID of this application instance. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="classPassenger_1_1Application.html#d14f673494991460b16246a527ad8ad9">SessionPtr</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPassenger_1_1Application.html#34636f796ff3924ad5ec142aaa581379">connect</a> (const function&lt; void()&gt; &amp;closeCallback) const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Connect to this application instance with the purpose of sending a request to the application.  <a href="#34636f796ff3924ad5ec142aaa581379"></a><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Represents a single Ruby on Rails or Rack application instance. <hr><h2>Member Typedef Documentation</h2>
<a class="anchor" name="d14f673494991460b16246a527ad8ad9"></a><!-- doxytag: member="Passenger::Application::SessionPtr" ref="d14f673494991460b16246a527ad8ad9" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef shared_ptr&lt;<a class="el" href="classPassenger_1_1Application_1_1Session.html">Session</a>&gt; <a class="el" href="classPassenger_1_1Application.html#d14f673494991460b16246a527ad8ad9">Passenger::Application::SessionPtr</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Convenient alias for <a class="el" href="classPassenger_1_1Application_1_1Session.html" title="Represents the life time of a single request/response pair of a Ruby on Rails or...">Session</a> smart pointer. 
<p>

</div>
</div><p>
<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="0ae83471a8c991b8cc8d460b44d237ea"></a><!-- doxytag: member="Passenger::Application::Application" ref="0ae83471a8c991b8cc8d460b44d237ea" args="(const string &amp;theAppRoot, pid_t pid, const string &amp;listenSocketName, const string &amp;listenSocketType, int ownerPipe)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Passenger::Application::Application           </td>
          <td>(</td>
          <td class="paramtype">const string &amp;&nbsp;</td>
          <td class="paramname"> <em>theAppRoot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pid_t&nbsp;</td>
          <td class="paramname"> <em>pid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const string &amp;&nbsp;</td>
          <td class="paramname"> <em>listenSocketName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const string &amp;&nbsp;</td>
          <td class="paramname"> <em>listenSocketType</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>ownerPipe</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Construct a new <a class="el" href="classPassenger_1_1Application.html" title="Represents a single Ruby on Rails or Rack application instance.">Application</a> object. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>theAppRoot</em>&nbsp;</td><td>The application root of an application. In case of a Rails application, this is the folder that contains 'app/', 'public/', 'config/', etc. This must be a valid directory, but the path does not have to be absolute. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pid</em>&nbsp;</td><td>The process ID of this application instance. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>listenSocketName</em>&nbsp;</td><td>The name of the listener socket of this application instance. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>listenSocketType</em>&nbsp;</td><td>The type of the listener socket, e.g. "unix" for Unix domain sockets. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ownerPipe</em>&nbsp;</td><td>The owner pipe of this application instance. </td></tr>
  </table>
</dl>
<dl class="post" compact><dt><b>Postcondition:</b></dt><dd><a class="el" href="classPassenger_1_1Application.html#0a0665852e7ebc8fb8ab0772fa90bc56" title="Returns the application root for this application.">getAppRoot()</a> == theAppRoot &amp;&amp; <a class="el" href="classPassenger_1_1Application.html#94d2cce1c2c1d3441325f1498a22bf02" title="Returns the process ID of this application instance.">getPid()</a> == pid </dd></dl>

</div>
</div><p>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="34636f796ff3924ad5ec142aaa581379"></a><!-- doxytag: member="Passenger::Application::connect" ref="34636f796ff3924ad5ec142aaa581379" args="(const function&lt; void()&gt; &amp;closeCallback) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classPassenger_1_1Application.html#d14f673494991460b16246a527ad8ad9">SessionPtr</a> Passenger::Application::connect           </td>
          <td>(</td>
          <td class="paramtype">const function&lt; void()&gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>closeCallback</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Connect to this application instance with the purpose of sending a request to the application. 
<p>
Once connected, a new session will be opened. This session represents the life time of a single request/response pair, and can be used to send the request data to the application instance, as well as receiving the response data.<p>
The use of <a class="el" href="classPassenger_1_1Application.html#34636f796ff3924ad5ec142aaa581379" title="Connect to this application instance with the purpose of sending a request to the...">connect()</a> is demonstrated in the following example. <div class="fragment"><pre class="fragment">   <span class="comment">// Connect to the application and get the newly opened session.</span>
   <a class="code" href="classPassenger_1_1Application.html#d14f673494991460b16246a527ad8ad9" title="Convenient alias for Session smart pointer.">Application::SessionPtr</a> session(app-&gt;connect(<span class="stringliteral">"/home/webapps/foo"</span>));
   
   <span class="comment">// Send the request headers and request body data.</span>
   session-&gt;sendHeaders(...);
   session-&gt;sendBodyBlock(...);
   <span class="comment">// Done sending data, so we close the writer channel.</span>
   session-&gt;shutdownWriter();

   <span class="comment">// Now read the HTTP response.</span>
   <span class="keywordtype">string</span> responseData = readAllDataFromSocket(session-&gt;getReader());
   <span class="comment">// Done reading data, so we close the reader channel.</span>
   session-&gt;shutdownReader();

   <span class="comment">// This session has now finished, so we close the session by resetting</span>
   <span class="comment">// the smart pointer to NULL (thereby destroying the Session object).</span>
   session.reset();

   <span class="comment">// We can connect to an Application multiple times. Just make sure</span>
   <span class="comment">// the previous session is closed.</span>
   session = app-&gt;connect(<span class="stringliteral">"/home/webapps/bar"</span>)
</pre></div><p>
Note that a RoR application instance can only process one request at the same time, and thus only one session at the same time. It's unspecified whether Rack applications can handle multiple simultanous sessions.<p>
You <b>must</b> close a session when you no longer need if. If you call <a class="el" href="classPassenger_1_1Application.html#34636f796ff3924ad5ec142aaa581379" title="Connect to this application instance with the purpose of sending a request to the...">connect()</a> without having properly closed a previous session, you might cause a deadlock because the application instance may be waiting for you to close the previous session.<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>A smart pointer to a <a class="el" href="classPassenger_1_1Application_1_1Session.html" title="Represents the life time of a single request/response pair of a Ruby on Rails or...">Session</a> object, which represents the created session. </dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>closeCallback</em>&nbsp;</td><td>A function which will be called when the session has been closed. </td></tr>
  </table>
</dl>
<dl class="post" compact><dt><b>Postcondition:</b></dt><dd>this-&gt;getSessions() == old-&gt;getSessions() + 1 </dd></dl>
<dl compact><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em><a class="el" href="classPassenger_1_1SystemException.html" title="Represents an error returned by a system call or a standard library call.">SystemException</a></em>&nbsp;</td><td>Something went wrong during the connection process. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em><a class="el" href="classPassenger_1_1IOException.html" title="Represents an error that occured during an I/O operation.">IOException</a></em>&nbsp;</td><td>Something went wrong during the connection process. </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="0a0665852e7ebc8fb8ab0772fa90bc56"></a><!-- doxytag: member="Passenger::Application::getAppRoot" ref="0a0665852e7ebc8fb8ab0772fa90bc56" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">string Passenger::Application::getAppRoot           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Returns the application root for this application. 
<p>
See the constructor for information about the application root. 
</div>
</div><p>
<hr>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="Application_8h-source.html">Application.h</a></ul>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Wed Apr 8 22:35:12 2009 for Passenger by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.8 </small></address>
</body>
</html>
